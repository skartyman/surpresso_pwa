<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">

  <title>–û–±–ª–∞–¥–Ω–∞–Ω–Ω—è –∫–æ–º–ø–∞–Ω—ñ—ó ‚Äî Surpresso Service</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    background: #eee;                 /* –∫–∞–∫ –≤ –¥—Ä—É–≥–æ–º –±–ª–∞–Ω–∫–µ */
    font-family: "Merriweather", serif;
  }

  /* ======= A5 page ======= */
  .page {
    width: 210mm;
    min-height: 146mm;              /* –±—ã–ª–æ height ‚Äî —Ç–µ–ø–µ—Ä—å min-height */
    padding: 6mm 10mm;
    box-sizing: border-box;
    background: white;
    margin: 8mm auto;
    display: flex;
    flex-direction: column;
    gap: 1mm;
  }

  /* ======= –ü–µ—á–∞—Ç—å A5 –∞–ª—å–±–æ–º–Ω–æ ======= */
  @media print {
    @page {
      size: A5 landscape;
      margin: 0;
    }

    body, html {
      margin: 0;
      padding: 0;
      background: white;
    }

    .page {
      margin: 0;
      width: 210mm;
      min-height: 146mm;
      padding: 6mm 10mm;
      box-sizing: border-box;
      page-break-inside: avoid;
      page-break-after: always;       /* –∫–∞–∂–¥–∞—è .page = –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç */
    }

    .page:last-child {
      page-break-after: auto;         /* –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é */
    }
  }

  .header {
  display: flex;
  justify-content: space-between;
  align-items: center; /* —á—Ç–æ–±—ã –ª–æ–≥–æ—Ç–∏–ø –∏ —Ç–µ–∫—Å—Ç –±—ã–ª–∏ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
  border-bottom: 2px solid #F2C94C;
  padding-bottom: 6px;
  margin-bottom: 8px;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ø—Ä–∞–≤–∞ */
.header-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}

/* –õ–æ–≥–æ—Ç–∏–ø */
.header-logo {
  height: 45px;   /* —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä */
  margin-bottom: 2px;
  object-fit: contain;
}

  .sub {
    font-size: 10px;
    color: #666;
  }

  .section-title {
    font-size: 12px;
    font-weight: 600;
    border-left: 3px solid #F2C94C;
    padding-left: 6px;
    margin-top: 4px;
  }

  .table {
    width: 100%;
    border-collapse: collapse;
    font-size: 10px;
    margin-top: 2px;
  }

  .table td, .table th {
    border-bottom: 1px solid #ddd;
    padding: 4px 6px;
  }

  .label {
    font-weight: 600;
    width: 35%;
  }

  .footer {
    margin-top: auto;
    font-size: 9px;
    text-align: center;
    color: #777;
  }

  .table.grid {
    border: 1px solid #000;
    border-collapse: collapse;
  }

  .table.grid td,
  .table.grid th {
    border: 1px solid #000;
    padding: 2px;
    height: 16px;
  }

  .first-block {
    font-size: 14px;
  }

  .first-block .table td {
    padding: 6px 8px;
    font-size: 14px;
  }

  .first-block .section-title {
    font-size: 15px;
  }

  .first-block input[type="checkbox"] {
    width: 15px;
    height: 15px;
  }

  /* —á—É—Ç—å —É–ø–ª–æ—Ç–Ω—è–µ–º –≤—Ç–æ—Ä—É—é —Å—Ç–æ—Ä–æ–Ω—É */
  .page:nth-of-type(2) .table {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  .page:nth-of-type(2) .section-title {
    margin-top: 2px !important;
    margin-bottom: 2px !important;
  }
  .page {
  position: relative;
  overflow: hidden;
}

/* -------------------------------
   –í–û–î–Ø–ù–û–ô –ó–ù–ê–ö (—ç–∫—Ä–∞–Ω –∏ –ø–µ—á–∞—Ç—å)
-------------------------------- */
.page.watermark::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  background-image: url("/icons/deer.jpg");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 120mm 120mm;

  opacity: 0.08;
  z-index: 1;
  pointer-events: none;
}

/* –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–≤–µ—Ä—Ö –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ */
.page.watermark > * {
  position: relative;
  z-index: 3;
}

/* -------------------------------
   –ü–ï–ß–ê–¢–¨
-------------------------------- */
@media print {
  @page {
    size: A5 landscape;
    margin: 0;
  }

  html, body {
    margin: 0;
    padding: 0;
    background: white;
  }

  .page {
    margin: 0;
    width: 210mm;
    height: 148mm;
    padding: 6mm 10mm;
    page-break-inside: avoid;
    page-break-after: always;

    overflow: visible !important;
    box-shadow: none;
    border: none;

    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  .page:last-child {
    page-break-after: auto;
  }

  .page.watermark::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("/icons/deer.jpg");
    background-repeat: no-repeat;
    background-position: center;
    background-size: 120mm 120mm;
    opacity: 0.08;
    z-index: 1;
    pointer-events: none;
  }
}
.parts-table th:nth-child(3),
.parts-table td:nth-child(3),
.parts-table th:nth-child(5),
.parts-table td:nth-child(5),
.parts-table th:nth-child(7),
.parts-table td:nth-child(7) {
  width: 50px;
  text-align: center;
}

/* –£–±–∏—Ä–∞–µ–º –ª–∏–Ω–∏–∏ –ø–æ–¥ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è–º–∏ */
.table td.no-border {
  border: none !important;
  padding: 2px 0;
  font-size: 10px;
  white-space: nowrap;
}
</style>
</head>
<body>

<!-- ==========================
     PAGE 1 (–ª–∏—Ü–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
============================= -->
<div class="page watermark">

  <div class="header">
    <div>
      <div class="logo">Surpresso Service</div>
      <div class="sub">–ö–∞—Ä—Ç–∫–∞ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è –∫–æ–º–ø–∞–Ω—ñ—ó</div>
    </div>
    <div class="header-right">
    <img src="/icons/deer.jpg" class="header-logo" alt="logo">
</div>
  </div>

  <div class="first-block">

    <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
    <div class="section-title">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</div>
    <table class="table" id="dataTable"></table>

    <!-- –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è -->
    <div class="section-title" style="margin-top:12px;">–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è (–ø–æ–∑–Ω–∞—á–∏—Ç–∏ –≥–∞–ª–æ—á–∫–æ—é ‚úì)</div>

    <table class="table complect-table" style="margin-top:6px;">
      <tr>
        <td><label><input type="checkbox"> –ü—ñ–¥–¥–æ–Ω</label></td>
        <td><label><input type="checkbox"> –ö–∞–±–µ–ª—å –∂–∏–≤–ª–µ–Ω–Ω—è</label></td>
        <td><label><input type="checkbox"> –ë—É–Ω–∫–µ—Ä–∏</label></td>
        <td><label><input type="checkbox"> –ö—Ä–∏—à–∫–∏</label></td>
      </tr>
      <tr>
        <td><label><input type="checkbox"> –•–æ–ª–¥–µ—Ä–∏</label></td>
        <td><label><input type="checkbox"> –ü–∞–Ω–∞—Ä–µ–ª–æ</label></td>
        <td><label><input type="checkbox"> –ö–∞–ø—É—á–∏–Ω–∞—Ç–æ—Ä</label></td>
        <td><label><input type="checkbox"> –ú–æ–ª–æ—á–Ω–∏–∫</label></td>
      </tr>
    </table>

    <!-- –ü—ñ–¥–ø–∏—Å -->
    <table class="table" style="margin-top:16px;">
      <tr>
        <td class="label">–ü—Ä–∏–π–Ω—è–≤ (–ü–Ü–ë)</td>
        <td>____________________________</td>
      </tr>
    </table>

  </div>

</div><!-- END PAGE 1 -->



<!-- ==========================
     PAGE 2 (–æ–±–æ—Ä–æ—Ç)
============================= -->

<div class="page watermark">
  <div class="section-title">–ñ—É—Ä–Ω–∞–ª —Ä–µ–º–æ–Ω—Ç—É / –ó–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è –≤—Ä—É—á–Ω—É</div>
  <table class="table">
    <tr><td class="label">–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É —Ä–µ–º–æ–Ω—Ç—É</td><td>2026 —Ä.</td></tr>
    <tr><td class="label">–†–µ–º–æ–Ω—Ç—É–≤–∞–≤ (–ü–Ü–ë)</td><td></td></tr>
  </table>
    <div class="section-title">–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∑–∞–ø—á–∞—Å—Ç–∏–Ω–∏</div>
<table class="table grid parts-table">
  <tr>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
  </tr>

  <tr>
    <td>1</td><td></td><td></td>
    <td>2</td><td></td><td></td>
    <td>3</td><td></td><td></td>
    <td>4</td><td></td><td></td>
  </tr>
  <tr>
    <td>5</td><td></td><td></td>
    <td>6</td><td></td><td></td>
    <td>7</td><td></td><td></td>
    <td>8</td><td></td><td></td>
  </tr>
  <tr>
    <td>9</td><td></td><td></td>
    <td>10</td><td></td><td></td>
    <td>11</td><td></td><td></td>
    <td>12</td><td></td><td></td>
  </tr>
  <tr>
    <td>13</td><td></td><td></td>
    <td>14</td><td></td><td></td>
    <td>15</td><td></td><td></td>
    <td>16</td><td></td><td></td>
  </tr>
  <tr>
    <td>17</td><td></td><td></td>
    <td>18</td><td></td><td></td>
    <td>19</td><td></td><td></td>
    <td>20</td><td></td><td></td>
  </tr>
  <tr>
    <td>21</td><td></td><td></td>
    <td>22</td><td></td><td></td>
    <td>23</td><td></td><td></td>
    <td>24</td><td></td><td></td>
  </tr>
</table>

<div class="section-title">–†–µ–º–æ–Ω—Ç–Ω—ñ —Ä–æ–±–æ—Ç–∏</div>
<table class="table grid repair-table">
  <tr>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å–ª—É–≥–∏</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å–ª—É–≥–∏</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:4%">‚Ññ</th>
    <th style="width:14%">–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å–ª—É–≥–∏</th>
    <th style="width:7%">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
    <th style="width:25%">–ê—É—Ç—Å–æ—Ä—Å</th>
  </tr>

  <tr>
    <td>1</td><td></td><td></td>
    <td>2</td><td></td><td></td>
    <td>3</td><td></td><td></td>
    <td></td>
  </tr>
  <tr>
    <td>4</td><td></td><td></td>
    <td>5</td><td></td><td></td>
    <td>6</td><td></td><td></td>
    <td></td>
  </tr>
  <tr>
    <td>7</td><td></td><td></td>
    <td>8</td><td></td><td></td>
    <td>9</td><td></td><td></td>
    <td></td>
  </tr>
</table>

<div class="section-title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</div>
<table class="table grid" style="margin-top:2px;">
  <tr><td colspan="2" style="height:16px;"></td></tr>
  <tr><td colspan="2" style="height:16px;"></td></tr>
  <tr><td colspan="2" style="height:16px;"></td></tr>
</table>

<table class="table grid" style="margin-top:2px;">
  <tr>
    <td class="label" style="width:50%">–î–∞—Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è —Ä–µ–º–æ–Ω—Ç—É</td>
    <td style="width:50%">2026 —Ä.</td>
  </tr>
  <tr>
    <td class="label">–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –∑–∞ —á–µ–∫-–ª–∏—Å—Ç–æ–º</td>
    <td></td>
  </tr>
  <tr>
    <td><input type="checkbox"> –ó—Ä–æ–±–ª–µ–Ω–æ —Ä–∞—Ö—É–Ω–æ–∫</td>
    <td><input type="checkbox"> –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —ñ–Ω–∂–µ–Ω–µ—Ä—É</td>
  </tr>
</table>
</div>
</body>




<script>
function formatDateForTable(dateStr) {
  if (!dateStr) return "";
  const d = new Date(dateStr);
  if (isNaN(d)) return dateStr;
  const day = String(d.getDate()).padStart(2, "0");
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const year = d.getFullYear();
  return `${day}.${month}.${year}`;
}

const cardRaw = localStorage.getItem("last_equipment_card");
let card = null;
try { card = JSON.parse(cardRaw || "null"); } catch (e) {}

const docEl = document.getElementById("docId");
if (docEl) docEl.textContent = card?.id || "-";

function row(label, value) {
  return `<tr><td class="label">${label}</td><td>${value || "-"}</td></tr>`;
}

let html = "";

if (card && card.owner === "company") {
  html += row("–¢–∏–ø –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è", card.typeText);
  html += row("–í–ª–∞—Å–Ω–∏–∫", "–ö–æ–º–ø–∞–Ω—ñ—è");
  html += row("–õ–æ–∫–∞—Ü—ñ—è (—Ü–µ—Ö / –∑–∞–∫–ª–∞–¥)", card.companyLocation);
  html += row("–ù–∞–∑–≤–∞ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è", card.name);
  html += row("–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –Ω–æ–º–µ—Ä", card.internalNumber);
  html += row("–ó–∞–≤–¥–∞–Ω–Ω—è / –ø—Ä–æ–±–ª–µ–º–∞", card.task);
  html += row("–ö–æ–º–µ–Ω—Ç–∞—Ä", card.comment);
  html += row("–î–∞—Ç–∞", formatDateForTable(card.companyDate));
} else {
  html += row("–î–∞–Ω—ñ", "–ù–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –¥–∞–Ω—ñ –∫–∞—Ä—Ç–∫–∏.");
}

document.getElementById("dataTable").innerHTML = html;

  const PWA_KEY_STORAGE = "surpresso_pwa_key";
  const API_BASE = "";

  const $ = (s) => document.querySelector(s);

  const params = new URLSearchParams(location.search);
  const id = (params.get("id") || "").trim();

  function getKey() {
    return localStorage.getItem(PWA_KEY_STORAGE) || "";
  }

  function ensureKey() {
    let k = getKey();
    if (k) return k;
    k = (prompt("–í–≤–µ–¥–∏ –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É (PWA Key):") || "").trim();
    if (!k) return "";
    localStorage.setItem(PWA_KEY_STORAGE, k);
    return k;
  }

  function headersWithKey() {
    const k = ensureKey();
    return k ? { "x-surpresso-key": k } : {};
  }

  async function apiGet(url) {
    const resp = await fetch(url, { headers: headersWithKey() });
    return await resp.json();
  }

  async function loadAndRender() {
    if (!id) return alert("–ù–µ–º–∞—î ID");

    const data = await apiGet(`${API_BASE}/api/equip/${encodeURIComponent(id)}`);
    if (!data.ok) return alert(data.error || "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è");

    const eq = data.equipment || {};

    // üëá –¢–£–¢ –¢–´ –ü–û–î–°–¢–ê–í–õ–Ø–ï–®–¨ –í –°–í–û–ô –®–ê–ë–õ–û–ù
    // –ø—Ä–∏–º–µ—Ä:
    const elId = document.getElementById("printId");
    if (elId) elId.textContent = eq.id || "";

    // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ñ–æ—Ç–∫–∏ –Ω–∞ –ø–µ—á–∞—Ç—å:
    // data.photos = [{imgUrl, caption, ...}]
    const photosWrap = document.getElementById("printPhotos");
    if (photosWrap && Array.isArray(data.photos)) {
      const slice = data.photos.slice(0, 6);
      photosWrap.innerHTML = slice.map(p => `
        <div style="width:48%;border:1px solid #eee;border-radius:10px;overflow:hidden;margin-bottom:8px;">
          <img src="${p.imgUrl || ''}" style="width:100%;height:180px;object-fit:cover;display:block;">
          <div style="padding:6px 8px;font-size:11px;color:#666">${p.caption || ""}</div>
        </div>
      `).join("");
    }

    // ‚úÖ –ü–µ—á–∞—Ç—å –ø–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
    setTimeout(() => window.print(), 300);
  }

  loadAndRender();
</script>

</body>
</html>


